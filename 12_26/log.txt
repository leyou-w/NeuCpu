================================================================================
12_26/SampleCPU MIPS处理器项目详细功能说明
================================================================================

项目概述
========
12_26/SampleCPU是一个基于MIPS架构的五级流水线CPU设计项目，实现了完整的指令集支持，
包括算术逻辑运算、存储器访问、分支跳转、乘除法运算等功能。项目采用Verilog HDL实现，
具有数据前推、流水线暂停控制等高级特性，能够高效处理数据冒险和控制冒险问题。

项目总功能实现
==============

1. 五级流水线架构
   - IF（取指阶段）：从指令存储器获取指令，计算下一条指令地址
   - ID（译码阶段）：指令译码、寄存器读取、数据前推处理
   - EX（执行阶段）：算术逻辑运算、乘除法运算、地址计算
   - MEM（访存阶段）：数据存储器访问、HI/LO寄存器写回
   - WB（写回阶段）：寄存器堆写回、调试接口输出

2. 关键技术特性
   - 数据前推机制：解决RAW数据冒险，提高流水线效率
   - 流水线暂停控制：处理load-use数据冒险和乘除法指令等待
   - HI/LO寄存器支持：支持乘除法指令的高低位结果存储
   - 完整的MIPS指令集支持：包括算术、逻辑、移位、分支、跳转、存储器访问等指令

3. 存储器接口
   - 指令存储器接口：32位地址空间，支持字节寻址
   - 数据存储器接口：支持字节、半字、字访问，具有写使能控制

4. 调试接口
   - 提供写回阶段的PC值、寄存器写使能、目标寄存器号和写回数据
   - 便于与龙芯实验平台进行指令比对和调试

各文件功能详细说明
==================

顶层模块文件
------------

1. mycpu_core.v - CPU核心模块
   - 功能：实现五级流水线的顶层集成，连接各阶段模块
   - 接口：时钟、复位、中断、指令/数据存储器接口、调试接口
   - 特性：数据总线定义、前推通路、HI/LO寄存器信号、暂停控制

2. mycpu_top.v - CPU顶层模块（如存在）
   - 功能：CPU与外部环境的接口封装
   - 接口：时钟、复位、存储器接口等系统级信号

流水线阶段模块
--------------

3. IF.v - 取指阶段模块
   - 功能：从指令存储器获取指令，计算下一条指令地址
   - 特性：PC寄存器管理、分支跳转处理、流水线暂停控制
   - 输出：指令使能信号、PC值到ID阶段

4. ID.v - 译码阶段模块
   - 功能：指令译码、寄存器读取、数据前推、跳转判断
   - 特性：指令字段解码、寄存器文件访问、数据冒险检测
   - 支持：操作码译码、立即数符号扩展、寄存器前推逻辑

5. EX.v - 执行阶段模块
   - 功能：算术逻辑运算、乘除法运算、地址计算
   - 特性：ALU操作、乘除法器接口、HI/LO寄存器操作
   - 支持：多种ALU操作类型、操作数选择、存储器操作信号生成

6. MEM.v - 访存阶段模块
   - 功能：数据存储器访问、HI/LO寄存器写回
   - 特性：加载指令数据处理、存储器控制信号、数据前推
   - 支持：字节、半字、字访问，符号/零扩展处理

7. WB.v - 写回阶段模块
   - 功能：寄存器堆写回、调试接口输出
   - 特性：流水线寄存器控制、结果选择、调试信号输出

控制模块
--------

8. CTRL.v - 流水线控制模块
   - 功能：根据暂停请求生成流水线暂停控制信号
   - 特性：处理load指令暂停和EX阶段暂停请求
   - 输出：6位暂停控制信号，控制各流水线阶段

功能模块库（lib目录）
--------------------

9. alu.v - 算术逻辑单元
   - 功能：实现MIPS指令集的算术和逻辑运算
   - 支持：加法、减法、比较、逻辑运算、移位等操作
   - 特性：多路选择器控制运算类型，支持有符号/无符号运算

10. div.v - 除法器模块
    - 功能：实现32位有符号/无符号除法运算
    - 特性：状态机控制、迭代计算、异常处理（除零）
    - 支持：商和余数计算，状态机管理除法过程

11. hilo_reg.v - HI/LO寄存器模块
    - 功能：管理乘除法指令的HI和LO寄存器
    - 特性：流水线前推、暂停控制、数据写回
    - 支持：乘除法结果的64位存储和转发

12. mul.v - 乘法器模块
    - 功能：实现32位有符号/无符号乘法运算
    - 特性：Booth算法编码、Wallace树结构、高速乘法
    - 支持：65位部分积累加，改进的Booth算法优化

13. regfile.v - 寄存器文件模块
    - 功能：管理32个32位通用寄存器
    - 特性：双读单写端口、异步读取、同步写入
    - 支持：寄存器0硬连线为0，符合MIPS规范

译码器模块
----------

14. docoder_2_4.v - 2-4译码器
    - 功能：将2位输入转换为4位独热码输出
    - 应用：控制信号生成、地址译码

15. decoder_5_32.v - 5-32译码器
    - 功能：将5位输入转换为32位独热码输出
    - 应用：寄存器选择、32位控制信号生成

16. decoder_6_64.v - 6-64译码器
    - 功能：将6位输入转换为64位独热码输出
    - 应用：扩展的寄存器选择、复杂控制信号解码

存储器管理模块
--------------

17. mmu.v - 内存管理单元
    - 功能：实现虚拟地址到物理地址的映射
    - 特性：处理Kseg0和Kseg1内核空间段映射
    - 支持：缓存和非缓存段的地址转换

乘法器子模块（mul目录）
----------------------

18. add.v - 65位加法器
    - 功能：实现三个65位输入的加法运算
    - 应用：乘法器中的部分积累加运算
    - 特性：全加器级联结构，支持进位传播

19. fa.v - 全加器模块
    - 功能：实现1位全加器功能
    - 应用：构建多位加法器的基础单元
    - 特性：两级逻辑门实现，高速运算

头文件
------

20. defines.vh - 常量定义文件
    - 功能：定义总线宽度、控制信号和状态常量
    - 包含：流水线总线宽度、暂停控制信号、除法器状态等

项目技术亮点
============

1. 完整的流水线设计
   - 标准的五级流水线架构，支持指令级并行
   - 精心设计的流水线寄存器，确保数据正确传递

2. 高效的数据冒险处理
   - 三级数据前推机制（EX、MEM、WB阶段）
   - 智能的暂停控制，最小化流水线停顿

3. 完整的乘除法支持
   - 独立的乘除法器模块，支持有符号/无符号运算
   - HI/LO寄存器管理，符合MIPS架构规范

4. 丰富的指令集支持
   - 算术指令：add、sub、and、or、xor等
   - 逻辑指令：sll、srl、sra等移位操作
   - 存储器指令：lw、sw、lb、lh等加载存储
   - 分支跳转：beq、bne、j、jal等控制流指令

5. 完善的调试接口
   - 提供写回阶段的完整信息
   - 便于与标准MIPS实现进行比对验证


================================================================================